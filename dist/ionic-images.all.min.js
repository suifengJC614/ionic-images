!function(){var i=angular.module("ion-images",["ionic"]);i.constant("imgUtils",{isType:function(i,n){return"Null"===n&&null===i||"Undefined"===n&&void 0===i||"Number"===n&&isFinite(i)||Object.prototype.toString.call(i).slice(8,-1)===n}}),Array.prototype.insertAt=function(i,n){this.splice(i,0,n)}}();
!function(e){function t(t){function a(e,t,a,i){e.images=[]}function i(e,a,i,c,n){t.createModal({images:e.images}).then(function(t){e.modal=t,e.$watchCollection("images",function(){t.setImage(e.images)})})}function c(t){t.childs=[],this.compileChildImage=function(a,i,c){var n=t.col;n>5&&(n=5),n=parseInt(n);var o="";n>1&&(o="col-"+parseInt(100/n)),e(i).wrap("<li class='col "+o+"'></li>"),a.bgSrc&&t.images.push(a.bgSrc),t.childs.push({scope:a,element:i,attrs:c}),e(i).attr("data-index",t.childs.length-1)},this.clickImageWrap=function(a){var i=e(a).attr("data-index"),c={offset:e(a).offset()};t.modal.show(i,c)}}return{restrict:"E",replace:!0,transclude:!0,scope:{col:"@"},template:'<ul class="row img-group" ng-transclude></ul>',controller:["$scope",c],compile:function(e,t,c){return{pre:a,post:i}}}}var a=angular.module("ion-images");a.directive("imgGroup",t),t.$inject=["imageModal"]}(jQuery);
!function(c){function i(){function i(i,r,a,e){var n=c(r).find("div");e&&e.compileChildImage(i,r,a);var d=function(){i.bgSrc?n.css("background-image","url('"+i.bgSrc+"')"):n.css("background-image","")};i.clickWrap=function(){e&&e.clickImageWrap(r),"function"==typeof i.onClickWrap&&i.onClickWrap()},i.$watch(i.bgSrc,d)}return{restrict:"E",replace:!0,require:"^?imgGroup",scope:{delegateHandle:"@",bgSrc:"=",defAddClass:"@",onClickWrap:"&"},template:'<div class="col-img-wrap"><div></div><em></em></div>',compile:function(r,a){return c(r).find("div").attr({"ng-class":"{'"+(a.defAddClass?a.defAddClass:"def-add")+"': !bgSrc && onClickWrap}","ng-click":"clickWrap()"}),i}}}var r=angular.module("ion-images");r.directive("imgWrap",i)}(jQuery);
!function(o){function e(){function e(e,t,a,s,c){function n(n){n=o.extend({},i,n);var r=e.defer(),d=a.$new(!0);return d.data={},d.opts={touchMoveStopPropagation:!1},s.isType(n.images,"Array")?d.images=n.images:d.images=[],t.fromTemplateUrl("src/js/imageModal/image-modal.html",{scope:d,animation:"slide-fade"}).then(function(o){r.resolve(new l(d,o,c))}),r.promise}return{createModal:n}}var i={images:[]};this.$get=e,e.$inject=["$q","$ionicModal","$rootScope","imgUtils","$ionicScrollDelegate"]}function i(e){var i=this;i.src=e,i.zoom=1,o("<img/>").attr("src",e).load(function(){i.width=this.width,i.height=this.height})}function l(o,e,i){var l=this;l.modal=e,o.$watch("data.slider",function(){l.slider=o.data.slider,l.slider&&l.slider.params&&(l.slider.params.onSlideChangeEnd=o.slideChange)}),l.scope=o,l.clickCount=0,l.$ionicScrollDelegate=i,o.clickTap=function(o){l.clickCount++,1==l.clickCount&&setTimeout(function(){1==l.clickCount?l.hide():l.scale(o),l.clickCount=0},300)},o.wrapScroll=function(o){var e=l.scope.images[o],i=l.$ionicScrollDelegate.$getByHandle("scroll"+o),t=i.getScrollView();if(e.zoom=t.__zoomLevel,1!=e.zoom&&l.slider.activeIndex==o){var a={scrollLeft:t.__scrollLeft,scrollTop:t.__scrollTop,maxScrollLeft:t.__maxScrollLeft,maxScrollTop:t.__maxScrollTop};a.scrollLeft>a.maxScrollLeft?l.allowSwipe(!0):a.scrollLeft<0?l.allowSwipe(!0):l.allowSwipe(!1)}},o.slideChange=function(){var o=l.slider.activeIndex,e=l.scope.images[o];l.allowSwipe(1==e.zoom)}}var t=angular.module("ion-images");t.provider("imageModal",e),l.prototype={setImage:function(o){if(o){var e=[];angular.forEach(o,function(o){e.push(new i(o))}),this.scope.images=e}},reset:function(){var o=this;this.scope.images.forEach(function(e,i){e.zoom=2,o.scale(i)})},show:function(o,e){this.slider.activeIndex=o,this.modal.show()},hide:function(){this.modal.hide(),this.reset()},scale:function(o){console.log(this.slider.isEnd);var e=this.scope.images[o];e.zoom=1==e.zoom?2:1;var i=this.$ionicScrollDelegate.$getByHandle("scroll"+o);console.log(i),i.zoomTo(e.zoom,!0),this.allowSwipe(1==e.zoom)},allowSwipe:function(o,e){e&&"next"!=e.toLowerCase()||(o?this.slider.unlockSwipeToNext():this.slider.lockSwipeToNext()),e&&"prev"!=e.toLowerCase()||(o?this.slider.unlockSwipeToPrev():this.slider.lockSwipeToPrev())}}}(jQuery);
!function(i){try{i=angular.module("ion-images")}catch(e){i=angular.module("ion-images",[])}i.run(["$templateCache",function(i){i.put("src/js/imageModal/image-modal.html",'<div class="modal image-model dark-bg"><ion-slides options=opts slider=data.slider><ion-slide-page ng-repeat="img in images track by $index" on-tap=clickTap($index)><ion-scroll delegate-handle=scroll{{$index}} direction=xy scrollbar-y=false zooming=true min-zoom=1 on-scroll=wrapScroll($index)><div class=img-wrap><img ng-src={{img.src}}><em></em></div></ion-scroll></ion-slide-page></ion-slides></div>')}])}();